\chapter{Literature Review}
\label{literatureReview}

\section{Wireless Sensor Networks}
\subsection{Applications Overview}
A WSN is a network of sensor nodes with the purpose of collecting sensor measurements from the target environment, and sending these measurements over the radio. One classic example is environmental monitoring, where sensor nodes are distributed over the area of interest measuring some properties there; such as temperature.
Sensor nodes can be used for continuous sensing, event detection, location sensing and local control of actuators. 

Current WSNs are deployed can five types of WSNs: terrestrial WSN (deployed in a given area on lands), underground WSN (sensor nodes deployed underground or in a cave of mine to monitor underground condition), underwater WSN (deployed into the ocean environment), multimedia WSN (equipped with camera and microphones to monitor and tracking of events in the form of multimedia such as video, audio and imaging. sensor devices that have the ability to store, process and retrieve multi-media data) and mobile WSN (nodes have the ability to reposition and organize itself in the network).\cite{wsnSurvey1}
We categorise the applications into///
There are 5 main applications of WSNs in monitoring and tracking; environment, health, home, military and other commercial areas. \cite{wsnSurvey2}.

Wireless multimedia sensor networks will not only enhance existing sensor network applications but they will also enable several new applications such as///
Multimedia WSN \cite{wsnSurvey3}.

The evolution of wireless sensor networks is largely driven by a set of emerging applications. The smart grid is intended to improve the electrical power grid and save considerable amounts of energy for society as a whole. Building and home automation improves the quality of indoor environments in terms of temperature, air quality, and lighting, while saving energy in the process. Industrial automation improves the quality of industrial processes. Smart cities allow new services inside increasingly populated cities such as automatic parking management and pollution monitoring. Wireless sensors are an integral part of all these applications \cite{beyondInteroperability}

The application can be categorised into 5; military, environment, health, home and other commercial areas \cite{wsnSurvey2}

\subsubsection{Environmental Applications}
Environment applications - Can be divided into 2; tracking the movements of birds, small animals and insects; monitoring environment conditions. Forest fire detection - sensor nodes can relay the exact origin of the fire to the end users before the fire is spread uncontrollable. Biocomplexity mapping of the environment \cite{Cerpahabitatmonitoring} observe the biocomplexity of the environment. Flood detection - ALERT system deployed in the US. Several types of sensors deployed in the ALERT system are rainfall, water level and weather sensors. Precision Agriculture - monitor the pesticides level in the drinking water, the level of soil erosion and the level of air pollution in real time. 
Volcanic monitoring \cite{volcano} with WSN can help accelerate the deployment, installation and maintenance process, WSN equipments are smaller, lighter and consume less power. The challenges of a WSN application for volcanic data collection include reliable event detection, efficient data collection, high data rates and sparse deployment of nodes. When an interesting event occurs, the node will route a message to the base station.

\subsubsection{Health Applications}
Health applications - Telemonitoring of human physiological data - can monitor and detect elderly people;s behaviour e.g. a fall; also allow doctors to identify pre-defined symptoms earlier; and facilitate a higher quality of life for the subjects compared to the treatment center; "Health Smart Home". Tracking and monitoring doctors and patients inside a hospital - one sensor may be detecting the heart rate while another is detecting the blood pressure; doctors may also carry a sensor node which allows other doctors to locate them within the hospital. Drug administration in hospitals \cite{telemonitoring} - sensor nodes can be attached to medication, the chances of getting and prescribing the wrong medication to patients can be minimized; patients have sensors that identify their allergies and required medications. 
Telecare is a system of wireless sensors placed around the home, which immediately detect risks such as fires, floods and falls. The moment a risk is detected an alert is sent to a telecare monitoring centre, summoning instant help 24 hours a day, 365 days a year. Telehealth is a small unit which enables you to take your vital signs from the comfort of your own home. You take readings such as blood pressure, oxygen levels, weight and temperature and they are automatically sent via telephone line to a monitoring centre. If your condition gets worse this will be picked up and your healthcare professional will be contacted to take appropriate action \cite{telehealth}. 
Telecare - a personal alarm where you raise the alert by pressing a button that you keep on you at all times. Usually, it's on a small wristband or a pendant that you wear around your neck. Motion sensors which make accidents and falls less likely by automatically switching on your bathroom or hallway lights at night when you get out of bed. Other sensors can raise the alarm that something is wrong, such as a pressure mat on your mattress that can tell if you've not made it back into bed, or a sensor on a door that senses if it's open or closed. Then, if you have a fall, or you haven't got back into bed after going to the toilet in the night, or you've forgotten to close the outside door, the sensor raises the alarm. Telehealth - there's also special telehealth equipment to monitor your health in your own home. It can be equipment to measure your blood pressure, blood glucose levels or your weight. This can reduce the number of visits you make to your GP and unplanned visits to the hospital. You're taught how to do the tests on yourself and the measurements are automatically transmitted to your doctor or nurse, who can then see the information without you having to leave home. They can let you know if they have any concerns.

\subsubsection{Home Applications}
Home automation \cite{homeautomation} - smart sensor nodes and actuators can be buried in appliances such as vacuum cleaners, microwaves ovens, refrigerators; these sensor nodes inside the domestic devices can interact with each other and with the external network via the Internet or Satellite. Smart environment \cite{smartenvironment} - example is “Residential Laboratory” at Georgia Institute of Technology. Nest Thermostat - including activity sensors, a Wi-Fi radio, three temperature sensors and a humidity sensor. The activity sensors are used to activate the Auto Away feature which shuts down heating and cooling after an hour or two of inactivity to conserve energy. The Nest learns your heating and cooling habits over the first week of use and will create a schedule based on this usage. 
The near sensor detects motion near the Nest display. The far field activity sensor can detect motion up to 20 feet away. The sensors have 150 degree range. The sensors will detect whether anybody is actually in a room. The sensor will automatically brighten the LCD screen when the user approaches. If the sensors do not detect motion for two hours the unit will activate the away setting. 
The Nest Thermostat integrates information from its sensors and the outside weather. The activity sensors, humidity sensor which shows the indoor humidity and can manage your whole-home humidifier or dehumidifier, temperature sensors - there are three temperature sensors track your home's temperature and how quickly it changes, weather aware - Nest uses its Wi-Fi connection to keep an eye on current weather conditions and forecasts so it can understand how the outside temperature affects your energy use. 

\subsubsection{Military Applications}
Military applications - Some of military applications of sensor networks are monitoring friendly forces, equipment and ammunition - attached with small sensors that report the status; battlefield surveillance - critical terrains, approach routes, paths and straits can be rapidly covered with sensor networks and closely watched for the activities of the opposing forces; reconnaissance of opposing forces and terrain; targeting; battle damage assessment; nuclear, biological and chemical (NBC) attack detection and reconnaissance (scouting/exploring) - used as a chemical or biological warning system can provide the friendly forces with critical reaction time which drops casualties drastically.
PinPtr \cite{Simonpinptr} is an experimental counter-sniper system developed to detect and locate shooters. The system utilizes a dense deployment of sensors to detect and measure the time of arrival of muzzle blasts and shock waves from a shot. Sensors route their measurements to a base station to compute the shooter's location. The system was demonstrated and evaluated in various US Army test facilities providing a realistic urban environment.

\subsubsection{Other Commercial Applications}
Other commercial applications - Environmental control in office buildings - a distributed wireless sensor network system can be installed to control the air flow and temperature in different parts of the room. Interactive museums - example is the San Francisco Exploratorium that features a combination of data measurements and cause-and-effect experiment. Detecting and monitoring car thefts. Managing inventory control - each item in a warehouse may have a sensor node attached, the end users can track and locate where the inventories are at all times. Vehicle tracking and detection.
Smart Parking solutions from Streetline - more than 40 cities and universities in North America and Europe use the technology. Offer true real-time vehicle detection, which is a balancing act of speed, caution and smarts so that detection is incredibly fast, but not so fast that the system gets confused and reports false information. A smart parking system accurately senses vehicle occupancy in real time. Guides residents and visitors to available parking. Simplifies the parking experience and adds value for parking stakeholders such as drivers and merchants. Enables intelligent decisions using data, including real-time status applications and historical analytical reports. *Complete parking solution to improve the entire parking ecosystem for all space types. Every arrival and departure is detected in real-time. Motorist is guided to available parking. Motorist pays by phone and activates timer or pay by meter. Officer is guided to unpaid violations, overstays, no parking and restricted zones. Staff receives web-based analytics for decision making. The sensors will be able to detect if a car is parked over it, and therefore determine whether or not the space is vacant. 
Smart Parking in the UK - SmartPark is already operating in cities like Birmingham and in the central London Borough of Westminster.  SmartPark enables drivers to find a parking space quickly and simply within busy town and city centres. 
Semiconductor plants and oil tanker \cite{industrialsensor} application focus on preventive equipment maintenance using vibration signatures gathered by sensors to predict equipment failure.

\subsection{WSN Challenges and Issues}
There are several constraints. WSNs suffer from limitation of several network resources. Limited energy capacity - sensor nodes are battery powered, limited energy capacity. When reach certain threshold, sensor will become faulty and will not be able to function properly. Major impact on the network performance. Should (do something) so that sensors be as energy-efficient as possible to extend their lifetime and prolong the network lifetime and guarantee good performance overall.
Limited hardware resources (node capabilities) - limited processing and storage capacities. Can only perform limited computational functionalities.
Network characteristics and unreliable environment - sensors operate in a dynamic and unreliable environment. Sensor nodes are linked by a wireless medium which is noisy, error prone and time varying. Thus considering multi-channel. \cite{singh2010routing}

\section{Maximize Lifetime and Minimizing Energy}
-through routing protocol (clustering), adjust transmission range, MAC sleep awake 
-energy harvesting?

Evaluate performance for energy efficient using duty-cycle as an indicator of energy efficiency because accurately measuring the energy consumption of sensor nodes is difficult. \cite{y-mac}

It is necessary to estimate the network lifetime. It must be possible before network deployment to determine how long a network maintains operational before maintenance is required and batteries have to be replaces. Unfortunately, node lifetime is very dependent on the radio environment in which the node is operated. \cite{alexlifetime}

There are various definitions of network lifetime used by the authors. We review the definitions widely used in designing topology control algorithms. The implication of these definitions and their impact of the topology control performance. The various definitions of the terms:
The first node to die. The first node which fails in the network if used to define the network lifetime. ///(If the energy level of one host becomes zero, the simulatio1n stops.//// \cite{lifetimedef1} The failed node is often called a critical node.
The number of alive nodes. The number of alive nodes as a function of time (over time) \cite{lifetimedef2, smecn} is taken as a measure of network lifetime. A higher number of alive nodes is used to describe a longer network lifetime. \cite{smecn} also define network lifetime as the number of nodes still connected to the sink. ///The survival rate of the network is evaluated based on the number of nodes remaining connected to the base station.////
The fraction of alive nodes. The network lifetime is described by the fraction of surviving or alive nodes as a function of time. The network is alive while the fraction of surviving nodes remains above a target threshold value. 1Also, another definition where definition evaluate the lifetime based on the time until the packet delivery ratio drops drastically. ///We measure network lifetime as the fraction of transit nodes with non-zero energy as a function of time. We demonstrate the node survivability by measuring node survival rates as a function of time. Also, in our simulation, the traffic keeps constant. If the monitored packet delivery ratio drops dramatically after time, we can say that the network lifetime ends at that time. \cite{gaf}///


Network lifetime depends on many factors including network architecture and protocols, data collection initiation, lifetime definition, channel characteristics and energy consumption model. Two physical layer parameters are crucial to network lifetime: the channel state and the residual energy of sensors. It indicates that lifetime maximizing protocols should exploit both the channel state information and the residual energy information of individual sensors. Important network characteristics that affect network lifetime includes network architecture (routing topology), channel and energy consumption model - sensor sleeping, energy consumed in transmission, reception and possible channel acquisition; lifetime definition - network lifetime is the time span from the deployment to the instant when the network is considered nonfunctional. When a network should be considered nonfunctional is however, application-specific. It can be for example, the instant when the first sensor dies, a percentage of sensors die, the network partitions, or the loss of coverage occurs. Define the network lifetime as the time span until any sensor in the network dies (the first death) or no sensor has enough energy for transmission during a data collection (the first failure in data collection), whichever occurs first \cite{maxmin}.

A precise definition of a WSN lifetime is application dependent: some application might tolerate a loss of considerable number of nodes, while for other applications a loss of even a node is critical. Network lifetime is defined as the length of time until the first battery expends its available energy. Although network lifetime is strongly related to minimal remaining energy of all the nodes, the best network lifetime could not be achieved by only maximized the minimal remaining energy of all the nodes. Usually place too heavy burden of forwarding data on a couple of key nodes so that these nodes drain out their batteries quickly which shortens lifetime of the WSN \cite{erapl}.

Wireless systems are often powered by batteries whereby the system's energy consumption determines its lifetime.

The dominant energy consumer in most WSN nodes is the radio transceiver, so naturally it is important to reduce radio transceiver usage as much as possible in order to conserve energy. A vast number of WSN communication protocols have been developed in recent years aiming at this goal through $duty cycling$. Duty-cycled Medium Access Control (MAC) protocols are employed and nodes periodically alter transceiver operation between an energy efficient sleep state and energy costly listen state. Energy consumption of a node depends on the interference patterns. Developed a generic method for capturing interference characteristics and predicting a node's energy consumption. (energy consumption prediction based on interference measurement). WSN radios use nearly the same energy in all active modes of operation (send, receive, listen). Capture an interference pattern at a deployment site and use this pattern to estimate the energy consumption of a node deployed at this location in the future. \cite{alexlifetime}

////citeSOFTWARE-BASED DUNKELS. implement an on-line energy estimation technique in Contiki. These approaches measure the state of components, such as radio, sensors and LEDS, to calculate consumption./////CHECK!

ROUTING - Prolonging network lifetime and saving energy are two critical issues for WSNs. Routing protocols are needed in which data packets are transmitted via multi-hop manner to reach the sink or destination. Therefore, it is critical for a WSN to run effectively to design an energy-efficient routing algorithm in which battery energy is expended efficiently while the WSN has a longer lifetime. The best network lifetime could not be achieved by only considering the minimal remaining energy of all the nodes in the WSN. Combining the minimal remaining energy and total energy consumption plays a key role in prolonging network lifetime of a WSN \cite{erapl}.

POWER CONTROL - Topology control techniques for extending the lifetime of battery powered WSNs. Energy consumption and network lifetime are two commonly used evaluation metrics for measuring the impact of topology control algorithms on energy efficiency. The idea of topology control is to grant sensor nodes a sense of control over certain parameters such that these parameters can be manipulated in a way that benefit the network. \cite{azrinasurvey}

1. MAC - multichannel
2. Routing
3. Transmit power control

\subsection{MAC Protocols}
Radio module is a major energy consumer in a sensor node, much research has been devoted to designing energy efficient MAC protocols.
Main causes of energy consumption. Collisions - may happen when a node is within the transmission range of two or more nodes that are simultaneously transmitting so that it does not capture any frame. The energy drained in the transmission and reception of collided frames is just wasted. Overhearing - happens when a node drains energy receiving irrelevant packets or signals. Idle listening - when a node does not know when it will be the receiver of a frame; the node keeps its radio on while listening to the channel waiting for potential data frames. The amount of energy wasted whilst the radio is on is considerable even when it is neither receiving nor transmitting frames. Nodes waste considerable amounts of energy as they keep their radios on for large time intervals while listening to an idle channel. Energy-efficient MACs should make nodes sleep for long periods of time instead of enabling them to be permanently active. Put nodes to sleep as long as possible while avoiding deafness and reducing overhearing and overhead. In order to extend nodes lifetime, applications need to save more energy by lowering the duty cycle. Lowering the duty cycle implies putting nodes in sleep mode for larger periods, which means extending the check interval. \cite{macsurvey}

A major problem is deploying WSNs in their dependence on limited battery power. A main design criterion is to extend the lifetime of the network without jeopardizing reliable and efficient communications from sensor nodes to the other nodes as well as data sinks. One solution is the medium access control (MAC). The prime role of the MAC is to coordinate access to and transmission over a medium common to several nodes. The common medium is the wireless channel. Since the radio is controlled by the MAC, the MAC is central in optimizing the WSN's lifetime. The aim of a WSN design is to guarantee its longevity under the given energy and complexity constraints. The MAC plays a central part in this design since it controls the active and sleeping state of each node. The MAC protocols hence needs to trade longevity, reliability, fairness, scalability and latency; throughput is rarely a primary design factor. \cite{macsurvey}

Many energy-efficient MAC protocols have been proposed to improve the lifetime of sensor networks by reducing the energy consumed by idle listening and overhearing. The idle listening problem refers to a node listening to the channel even though there are no radio transmissions to receive. The overhearing problem refers to a node receiving a packet it is not intended to receive \cite{pwmac}. 

\subsection{Routing Protocols}
Topology control can be implemented in three ways. Minimizing the power incurred during transmission by means of adjusting the transmission range of the wireless radio of sensor nodes is a common approach adopted. In addition, sensor nodes that are sitting idle, not participating in transmitting and receiving can turn-off their radios or they can transit to sleep mode. Finally, topology control can be performed through a clustering approach. \cite{azrinasurvey}

A routing algorithm termed Energy-efficient Routing Algorithm to Prolong Lifetime (ERAPL) is proposed. A data gathering sequence (DGS) used to avoid and eliminate mutual transmission and loop transmission among nodes (node is only allowed to transmit to its neighboring node in forward direction only to avoid loop), is constructed and each node proportionally transmit traffic to the links confined in the DGS. The main task of the ERAPL is to determine the optimal outgoing traffic to maximize the network lifetime for a given WSN. In addition, a mathematical programming model, in which minimal remaining energy of nodes and total energy consumptions are included, is presented to optimized network lifetime. ERAPL is a centralised algorithm and runs at the sink; sink knows the topology of the WSN. Sink inform all the nodes in the WSN of a packet that contains the constructed DGS which guides all the nodes to transmit traffic to their respective neighbors so that mutual transmission among nodes and route loop is avoided and accordingly energy is saved. ERAPL can improve network lifetime while expending energy efficiently by constructing a DGS and finding the optimal outgoing traffic proportions for all the nodes to distribute packets to their respective neighbouring nodes \cite{erapl}. 

\subsection{Transmit Power Control}
Power control to improve energy efficiency of the wireless sensor network. Whilst it is a useful tool to control traffic flows, congestion and interference levels, the power savings due reduced transmission powers are negligible since the radio's power consumption is in the range of the transmit power levels typically employed for embedded WSN nodes. \cite{macsurvey}

Define topology control as a technique used in wireless ad hoc and sensor networks to reduce energy consumption (which is essential to extend the network operational time) and radio interference (with a positive effect on the network traffic carrying capacity). The goal of topology control is to dynamically change the nodes transmitting range in order to maintain some property of the communication graph (connectivity) while reducing the energy consumed by the node transceivers which is strictly related to the transmitting range. Besides reducing energy consumption, topology control has the positive effect of reducing contention when accessing the wireless channel. In general, when the nodes transmitting ranges are relatively short, many nodes can transmit simultaneously without interfering with each other, and the network capacity is increased.
The term topology control has been used with at least two different meanings in the ad hoc and sensor networks literature. Several authors consider as topology control techniques aimed at superimposing a hierarchy on an otherwise flat network organization in order to reduce, typically energy consumption. 
Another definition for topology control used is power control. Classify as power control those techniques that, by acting on the transmit power level of the nodes, aim at optimizing a single wireless transmission. Although this transmission might, in general, be multihop, the focus of power control is on the efficiency of a single (possibly multi-hop) wireless channel. \cite{santitopologycontrol}
///////(Describes power control as a technique in which nodes adjust the transmit power to achieve a nodewide perspective such as energy efficient algorithms of the wireless transceiver. It is the technique that aims to select the best transmit power level for a single wireless transmission, possibly involving several hops. In this case, it has a channel-wide perspective.)/// \cite{azrinasurvey}   

Topology control has been interchangeably used with power control. Define topology control as a technique that uses any controlled network parameter to generate and maintain a topology for the benefits of reducing energy consumption and achieving a desired property for an entire network. The possible controlled parameters that can be modified to gain a desired topology are transmission power, modes of nodes and role of nodes.
Topology control - sensor nodes have the capacity to adjust the transmission range of their radio, switch to the various modes of operation or even decide on the eligibility of the nodes joining the network backbone. These features are the parameters that are exploited in enforcing a reduced topology to achieve energy saving and prolong network lifetime. Topology control offers a mechanism that allows sensor nodes to vary their transmission range which potentially reduces the energy consumption during transmission. As a result, the long distance communication links are dropped while the short distance communication links are chosen. From the perspective of energy consumption, a direct communication over short distance is more energy efficient that the long distance communication. Therefore, reducing the transmission power will eliminate the long distance links that can waste energy resources. The second objective is to overcome collisions. Other than discarding inefficient links, the use of minimal transmission range successfully removes the long distance nodes, thus resulting in a sparce network. The effect of this includes a reduction in the packet retransmissions and interference and an improvement in the network capacity. \cite{azrinasurvey}

The power adjustment approach allows nodes to vary their transmission power to reduce energy incurred in transmission. Rather than transmitting at maximum transmission power, nodes work in a collaborative manner to adjust and find the appropriate transmission power to form a connected network. A lower transmission power is sufficient to enclose a dense network whereas a much higher transmission power is needed to enclose a sparse network.\cite{azrinasurvey}

\subsection{Energy Harvesting}
Energy harvesting involves nodes replenishing its energy from an energy source. Potential energy sources include solar cells, vibration, fuel cells, acoustic noise and a mobile supplier. In terms of harvesting energy from the environment, solar cell is the current mature technique that harvest energy from light. There is also work in using mobile energy supplier such as a robot to replenish energy. The robots would be responsible in charging themselves with energy and then delivering energy to nodes \cite{wsnSurvey1}.

Sparse sensor placement may result in long-range transmission and higher energy usage while dense sensor placement may result in short-range transmission and less energy consumption.

Note that different powering mechanisms are available, such as non-rechargeable battery; rechargeable battery with regular recharging (e.g. sunlight); rechargeable battery with irregular recharging (e.g. opportunistic energy scavenging); capacitive/inductive energy provision (e.g. RFPD); etc \cite{macsurvey}.

\section{Multichannel Protocol (Data Link Layer)}
In single-channel MAC protocols, all nodes are configured to use a single frequency all the time. Frequency-agile MAC protocols switch between multiple frequencies during run-time. Recent radio chips are able to switch between frequency channels fast (e.g. in less than 100$\mu$s). Multi-channel can be used to increase robustness against narrowband long-lasting and transient interference. \cite{macsurvey}

\subsection{Introduction (Solutions)}
Multichannel communication has potential benefits for wireless networks that possibly include improved resilience against external interference, reduced latency, enhanced reception rate and increased throughput. 
There have been some proposals/solutions for multichannel. These approaches focus on (the mac layer) and depending on ().

The duty cycling technique saves energy by switching nodes between awake and sleeping states. The duty cycling is an important mechanism for reducing energy consumption in sensor networks. Existing duty cycling energy-efficient MAC protocols can be categorized into two types; synchronous and asynchronous.

Radio duty cycling mechanisms can be classified into two categories; synchronous and asynchronous systems. A synchronous system is a system that requires a tight time synchronization between nodes. It uses time-scheduled communication where the network clock needs to be periodically synchronized in order for the nodes not to drift in time. Asynchronous system on the other hand, do not require synchronization but instead is a sender or receiver initiated communication. In asynchronous systems the nodes are able to self-configure without time synchronization and this can have advantages. There are many studies done in multichannel for both categories.

The sender-initiated approach, a sender transmits preamble before a packet transmission to notify the receiver of the upcoming packet. With receiver-initiated approach, in contrast, sender preambles are replaced with receiver wakeup beacons. Receiver-initiated wakeup beacons are used to avoid long sender-initiated preambles. However, a larger sender duty cycle due to idle listening until the receiver wakes up. In sender-initiated protocols, a sender often shows much larger duty cycle than a receiver, transmitting the preamble until the receiver wakes up \cite{pwmac}. To overcome this, many sender-initiated protocols use predictive wakeup in sensor network MAC protocols to enable reducing the preamble length (WiseMAC - fixing the node wakeup interval. PW-MAC - wake up according to independently generated pseudo-random schedules).

If each nodes has an exclusive send time slot (synchronous/reservation-based protocol - sender-initiated approach)in two-hop neighborhood, collision-free access to the medium is guaranteed. Such a scheme is thus able to reduce energy waste by contention and collisions. However, all nodes must wake up at every time slot so as not to miss incoming messages. This results in energy wastage due to idle listening and overhearing. Therefore, scheduling receivers is more energy efficicnet than scheduling senders under light traffic conditions, because each node samples the medium only in its own receive time slot. The contention level is relatively low since contention among senders which have different destination nodes is eliminated. \cite{y-mac}

Two main approaches; reservation-based protocols (synchronous) where it requires the knowledge of the network topology to establish a schedule that allows each node to access the channel and communicate with other nodes. It needs dependency on network topology and time synchronization. Tight synchronization to ensure a common schedule among nodes. Both knowledge of topology and strict synchronization requires large overheads. Contention-based protocols - neither global synchronization nor topology knowledge is required. Nodes compete for the use of the wireless medium and only the winner of this competition is allowed to access to the channel and transmit. In CSMA for instance, a node having a packet to transmit first senses the channel before actually transmitting. In the case that the node finds the channel busy, it postpones its transmission to avoid interfering with the ongoing transmission. Contention-based protocols suffer from degraded performance in terms of throughput when the traffic load increases. \cite{macsurvey}

Contention-based MAC protocols can flexibly adapt to diverse traffic conditions by adjusting the duty cycle. However, they sacrifice energy during in the contention period (sending preamble packets). \cite{y-mac}

Multichannel communications has potential benefits for wireless networks that include improved resilience against external interference, reduced latency, enhanced receptiIn general, TDMA-based MAC protocols allocate a time slot to each node in the network. The allocated time slot is used for data transmission or data reception according to the protocol.on rate and increased throughput. We review a selected set of existing low power multichannel MAC protocols. Then we compare them objecieee802.15.4tively trying to highlight their features and limitations. 

\subsection{Synchronous Systems}
-TSCH, MC-LMAC, YMAC

TDMA based MAC protocol.
In general, TDMA-based MAC protocols allocate a time slot to each node in the network. The allocated time slot is used for data transmission or data reception according to the protocol. \cite{y-mac}

Crystal cloaks used for general sensor node platforms are typically cheap and inaccurate, all nodes have to communicate periodically in order to compensate for time synchronization errors resulting from clock drift. \cite{y-mac}

Scheduled communication has the advantage of collision-free access.

Higher latency is a typical characteristic of the schedule-based protocols. If a node has a packet to transmit it has to wait till its assigned slot.

\subsubsection{TSCH}
TSCH at its core is a medium access technique that uses time synchronization to achieve low-power operation and channel hopping to enable high reliability. TSCH focuses on the MAC layer only. TSCH is designed to allow optimizations and strong customizations, simplifying the merging of TSCH with a protocol stack based on IPv6, 6LoWPAN and RPL. TSCH differs from other low-power MAC protocols because of its scheduled nature. TSCH defines the mechanisms to execute a communication schedule. It is the entity that sets up the schedule that controls the topology of the network. This scheduling entity also controls the resources allocated to each link in that topology. At all times, a TSCH node needs to have a time-source neighbor which it can synchronize. The number of cells in a TSCH schedulemc-mlac  to assign between neighbor nodes nodes to be appropriate for the size of the traffic flow. TSCH defines mechanisms for a node to signal when it cannot accept an incoming packet. It does not define the policy that determines when to stop accepting packets. 

TSCH protocol highlights - overview of the key features of the IEEE802.15.4e TSCH amendment. All nodes in a TSCH network are synchronized. Time is sliced up into time slots. A time slot is long enough for a MAC frame of maximum size to be sent from the sender node to the receiver node and for the receiver node to reply with an acknowledgement (ACK) frame indicating successfulieee802.15.4 reception. Time slots are grouped into one of more slotframes. A slotframe continuously repeats over time. TSCH does not impose a slotframe size. The shorter the slotframe, the more often a time slot repeats, resulting in more available bandwidth but also in a higher power consumption. A TSCH schedule instructs each node what to do in each time slot: transmit, receive or sleep. The schedule indicates for each schedule (transmit of receive - transmissions take precedence over receptions) cell a schannelOffset and the address of the neighbor with which to communicate. For each transmit cell, the node checks whether there is a packet in the outgoing buffer that matches the neighbor written in the schedule information for that time slot. For each receive cell, the node listens for possible incoming packets. How the schedule is built, updated and maintained is outside of the scope of the IEEE 802.15.4e standard. Each scheduled transmit cell within thieee802.15.4e TSCH schedule is dedicated (reserved) for the node. However, it also allows a cell to be marked as shared. Multiple nodes can transmit at the same time on the same frequency. To avoid contention TSCH defines a backoff algorithm for shared cells. 

A scheduled cell can be marked as both transmitting and receiving. TSCH defines a timeslot counter called Absolute Slot Number (ASN). The ASN is used to calculate the frequency to communicate on and can be used for security-related operations. channelOffset is translated by the sender and receiver nodes into a different frequency at different slotframe cycles taking into account the value of ASN. Since both nodes have the same channelOffset written in their schedule for the scheduled cell and the same ASN counter, they compute the same frequency. At the next iteration (cycle) of the slotframe, while the channelOffset is the same, the ASieee802.15.4N has changed resulting in the computation of a different frequency.Use 5 channels in the experiment.) The sequence number generation algorithm must guarantee that there is only one node among one-hop neighbors on any particulate channel. The receiving node transmits a smal This results in "channel hopping": even with a static schedule, pairs of neighbors "hop" between the different frequencies when communication. Channel hopping is a technique known to efficiently combat multi-path fading and external interference and these impact a wireless link between two nodes differently on each frequency. If a transmission fails, retransmitting on a different frequency has a higher likelihood of succeeding that retransmitting on the same frequency. Channel hopping results in more stable links and therefore a more stable topology. Multiple pairs of neighbor nodes can exchange data at the same time but on different frequencies.
ieee802.15.4
Because of the slotted nature of communication in a TSCH network, nodes have to maintain tight synchronization. All nodes are assumed to be equipped with clocks to keep track of time. Because clocks in different nodes drift with respect to one another, neighbor nodes need to periodIn general, TDMA-based MAC protocols allocate a time slot to each node in the network. The allocated time slot is used for data transmission or data reception according to the protocol.ically resynchronize. Each node needs to periodically synchronize its network clock to another node, and it also provides its network time to its neighbors. TSCH adds timing information in all packets that are exchanged. This means that neighbor nodes can resynchronize to one another whenever they exchange data. In the absence of data traffic, nodes are required to synchronize to their time source neighbour(s) periodically not to drift in time. 

Nodes already part of the network can periodically send EB (Enhanced Beacons - contains timing information,In general, TDMA-based MAC protocols allocate a time slot to each node in the network. The allocated time slot is used for data transmission or data reception according to the protocol. channel hopping information, timeslot and slotframe information) frames. EB frames are sent on all  frequencies. A node wishing to join the network listens for EBs. The joining node can listen on any frequency until it hears an EB. What frequency it listens on is implementation specific. The new node enables the TSCH mode and use the information from the EB to synchronize to the network and it knows how to contact other nodes in network. \cite{tsch}

\subsubsection{MC-LMAC}
Present a multi-channel MAC protocol, MC-LMAC, designed with the objective of maximizing the throughput of WSNs by coordinating transmissions over multiple frequency channels. MC-LMAC takes advantage of interference and contention-free parallel transmissions on different channels. It is based on scheduled access and dynamically switches their interfaces between channels. Time is slotted and each node is assigned the control over a time slot to transmit onUse 5 channels in the experiment.) The sequence number generation algorithm must guarantee that there is only one node among one-hop neighbors on any particulate channel. The receiving node transmits a smal a particular channel. 

Multi-Channel Lightweight Medium Access Control (MC-LMAC) is a schedule-based multi-channel MAC protocol that takes advantage of contention and collision-free parallel transmissions on different channels. The main design is based on single-channel LMAC \cite{lmac}. LMAC protocol enables the communicating entities to access the wireless medium on a schedule basis in which each node periodically uses a timeslot for transmission. Present a new multi-channel MAC protocol with a fully distributed scheduling mechanism that does not require a centralized scheduler to allocate timeslots. Nodes discover and take control of their slots and channels in a localized way by only exchanging information within their local neighborhood in MC-LMAC. MC-LMAC not only support many-to-one communication toward the sink node but also broadcasts and local-gossip operations. 

MC-LMAC uses a common channel during the control period of each timeslot to let the receivers be informed about the requests and channels on which data will be sent. In MC-LMAC communication on a common channel at the beginning of each timeslot lets the new node collect full information about its neighborhood before starting transmission. If a node are switching between channel dynamically - MC-LMAC, all the receivers of a broadcast are informed on the common channel at the beginning of each slot. MC-LMAC does not require a dedicated broadcast channel. At the start of each timeslot, all nodes are required to listen on a common channel (different from the dedicated broadcast channel, this can be used for data exchanges as well) in order to exchange control information. 

MC-LMAC protocol we assume scheduled access, where each node is granted a timeslot and performs its transmissions within this timeslot without contention. 

To access the medium and send messages,nodes select/control a timeslot together with a frequency on which the transmission do not conflict with the other concurrent transmissions. 

In the initialization state, nodes sample the medium for an upcoming packet to synchronize with the network and enter the synchronization state. Every node synchronizes with its parents. Prior to data transmission, the nodes send control messages which include information about the current slot and frame numbers. Upon the reception of a message during initialization, a node records the current slot and frame numbers which are sent in the control message. The timing scheme is started by the sink node at network initialization. When the neighbors of the sink receive the transmission, they synchronize their clocks with the sink's clock. The synchronization continues hop-by-hop as each node synchronizes with its parent node. The nodes detect synchronization errors by comparing the received slot and frame numbers in the control message with their local slot and slot numbers. If a difference is detected, nodes transmit back to the initialization state. 

The nodes choose a time slot autonomously such that a node's transmissions in that slot does not conflict with the transmissions of other nodes in the same slot. If there is no conflict, a node uses the same time slot in the upcoming frames. Time slot selection process takes place either during network initialization or whenever a conflict occurs and a node is required to select a new time slot to eliminate conflict. If the time slots are selected during network initialization, the sink node starts the selection process by getting the control of a time slot. When a node joins a network, first it has to discover a free time slot to transmit its data. Potential receivers should transmit a list of the time slots during which they are already receiving. The scheme lets the new node determine the list of free slots that can be used without possible collisions. A node randomly selects its time slot from the set of free slots. All the nodes are given an opportunity to select an empty slot. This guarantees that every node can select a slot to carry out its transmissions without conflicts. All the nodes keep a bit vector called occupied slot vector. It is used for storing the information about the slots occupied by neighbors and is transmitted during the node's time slot to share this information with potential transmitters. 

In MC-LMAC time slots are selected with channels. A node can use the same time slot that is used by a 2-hop neighbor on a different frequency so that parallel transmissions are not disturbed at common neighbours. Consequently, more transmissions can take place with the same number of time slots. In MC-LMAC, a node occupies slot vectors per channel and selects a time slot to be used on a particular channel. Rules of MC-LMAC, a node does not select a time slot on any of the frequencies which is used by the neighbors. 

A time slot consists of a common frequency (CF) phase and a split phase. In the CF phase, all nodes switch to the common control channel to address their destinations and to be informed whether they are addressed in the current slot. In the split phase, senders and intended receivers switch to the channel on which the control message and data transmission will take place. During the CF phase, the intended destination id and node id are transmitted. This enables the sender to notify the destination node and invite it to switch its radio to the sender's channel. The sender's channel number is equal to the index or CF slot number where it notifies the destination node. Therefore, no extra information is needed to be transmitted. In the split phase, the sender first sends a control message which can be considered as a preamble packet, and then continues with the transmission of the data message. 

The receivers listen during the whole CF phase in order to be informed about the intended destinations. It switches its transceiver on the sender's associated frequency or to standby mode by entering into a passive state for the remainder of the time slot to conserve energy. Nodes can also send broadcast messages by transmitting a broadcast address during the CF slot. All the nodes receiving the broadcast request switch to the sender's frequency. 

In MC-LMAC the duration of the CF period increases with more channels and this causes the nodes to spend more energy on listening for the potential incoming packets. \cite{mc-lmac}

\subsubsection{YMAC}
Proposes an energy efficient multi-channel MAC protocol Y-MAC. A light-weight channel hopping mechanism. Y-MAC avoids redundant channel assignment by not allocating fixed channels to the nodes. Initially, messages are exchanged on the base channel. When a traffic burst occurs, a receiver and potential senders hop to one of other available channels, according to the hopping sequence. Each node is guaranteed to receive at least one message on the base channel. 

Y-MAC is a TDMA-based multi-channel MAC protocol. In general, TDMA-based MAC protocols allocate a time slot to each node in the network. The allocated time slot is used for data transmission or data reception according to the protocol.

In Y-MAC, time is divided into several fixed-length frames and each frame is composed of a broadcast period and a unicast period. Every node must wake up at the start of the broadcast period to exchange broadcast messages. If there are no incoming broadcast messages, each node turns off its radio, until its own receive time slot to save energy. Y-MAC separates broadcast traffic from unicast traffic, this makes broadcasting more reliable (separate broadcast message queue and unicast message queue). Broadcast messages are exchanged only within the broadcast period. At the beginning of the broadcast period, every node tunes to the base channel. 

Y-MAC propose a light-weight channel hopping mechanism exploiting multiple channels to reduce the packet delivery latency in unicast. If a node receives a unicast message on the base channel, it hops to the next channel to receive the following message. The next channel is calculated by the hopping sequence generation algorithm. Any nodes that have pending messages destined to the same receiver also hop to the same channel and compete again. In this way, bursts of messages ripple across channels and only one node uses the base channel at any one time. (successive packets are sent each on a different frequency following a pre-determined hopping sequence. This hopping sequence starts at the base station. Use 5 channels in the experiment.) The sequence number generation algorithm must guarantee that there is only one node among one-hop neighbors on any particulate channel. The receiving node transmits a small and independent packet at the start of the time slot to notify the contention losers whether it will wait during the next time slot or not (unicast time slot - contention loser can retry in the next time slot on the next channel). 

There's a tradeoff between the number of time slots and the delivery latency. The more time slots we have, the more nodes we can allocate exclusive time slots to, but delivery latency increases due to the prolonged length of the frame period. 

A sender and a receiver have to agree on the communication channel as well as the transmission timing. This necessitates time synchronization algorithms. In Y-MAC, sensor nodes synchronize their upcoming timer events by exchanging the time remaining in the current superframe period. Implemented by adjusting the expiration times of timer events. Time synchronized nodes periodically broadcast the information required for time synchronization. This consists of the time remaining to the start of the next frame period. Sink periodically broadcasts control messages to initiate the network. A node which is trying to join the network turns on its radio transceiver to receive this timing information. Once a node receives the first control message, it sets its time remaining to the next frame period to equal that of the sender. When the receiving node receives the time synchronization information from the sending node, it averages the time remaining and adjusts the expiration time of its timer event for timing error compensation. As a result, the starting points for the next frame period of these two nodes get closer. To lessen the control overhead for time synchronization, the timing information is included in control messages the every node periodically broadcasts to maintain network connectivity. 

The medium access design of Y-MAC is based on synchronous low power listening. We define the time slot length to be long enough to receive one message. Contention winner (contention between potential senders) can transmit a message to the destination node. If the channel is clear, a preamble is transmitted until the end of the contention window to suppress competing transmissions. The receiver wakes up at the end of the contention window to receive the data. \cite{y-mac}

\subsection{Asynchronous Systems}
%-EM-MAC, MuChMAC, Chrysso, MiCMAC - ContikiMAC?
Recent asynchronous multi channel MAC layers are Chrysso and MiCMAC. MiCMAC is built based on ContikiMAC, the default radio duty cycling in Contiki 2.7 that works in a single channel. The details of these are explained below.

\subsubsection{ContikiMAC}
ContikiMAC radio duty cycling mechanism is the default radio duty cycling mechanism in Contiki 2.7. It uses a power efficient wake up mechanism with a set of timing constraints to allow device to keep their transceivers off. The wireless transceiver consumes as much power when passively listening for transmissions from other devices as it does when actively transmitting, so the transceiver must be completely turned off to save power. ContikiMAC keep their radios turned off for roughly 99\% of the time.  ContikiMAC uses only asynchronous mechanisms, no signalling messages, and no additional packet headers. ContikiMAC packets are ordinary link layer messages. ContikiMAC uses a fast sleep optimization, to allow receivers to quickly detect false positive wake-ups (fast sleep optimization to allow receivers to quickly go to sleep when faced with spurious radio interference), and a transmission phase-lock optimization. The idea of periodic wake-ups has been used by many protocols, such as B-MAC, X-MAC and BoX-MAC. The phase-lock optimization has been previously suggested by WiseMAC and has since been used by other protocols as well. 

ContikiMAC uses a fast sleep optimization, to allow receivers to quickly detect false-positive wake-up and a transmission phase-lock optimization, to allow run-time optimization of the energy-efficiency of transmissions. 

ContikiMAC is a radio duty cycling protocol that uses periodical wake-ups to listen for packet transmissions from neighbors. If a packet transmission is detected during a wake-up, the receiver is kept on to be able to receive the packet. UNICAST - When the packet is successfully received, the receiver sends a link layer acknowledgement. To transmit a packet, a sender repeatedly sends its packet until it receives a link layer acknowledgement from the receiver. Acknowledgement transmission is done as part of the unicast packet reception. Packets that are sent as broadcasts do not result in link layer acknowledgements. Instead, the sender repeatedly sends the packet during the full wake-up interval to ensure that all neighbors have received it. Since a broadcast transmission does not expect any link layer acknowledgement, the transmitter can turn of its radio between each packet transmission to save power.

ContikiMAC wake-up frequency of 8Hz which results in a wake-up interval of 125 ms. Radio duty cycle increase with the wake-up frequency; more wake-ups, the total power consumption of the network increase (channel check rate higher than 8Hz).

ContikiMAC wake-ups use an inexpensive Clear Channel Assessment (CCA) mechanism that uses the Received Signal Strength Indicator (RSSI) of the radio transceiver to give an indication of radio activity on the channel. If the RSSI is below a given threshold, the CCA returns positive, indicating that the channel is clear. If the RSSI is above the threshold, the CCA returns negative, indicating that the channel is in use.

\textbf{Detection - }
ContikiMAC CCAs do not reliably detect packet transmission: they only detect that the radio signal strength is above a certain threshold. The detection of a radio signal may mean that a neighbor is transmitting a packet to the receiver, that a neighbor is transmitting to another receiver, or that some other device is radiating radio energy that is being detected by the CCA mechanism. ContikiMAC must be able to discern between these events and react properly.

\textbf{Fast Sleep - }
The fast sleep optimization lets potential receivers go to sleep earlier if the CCA woke up due to spurious radio noise. Specific pattern of ContikiMAC transmissions:
	If CCA detects radio activity but the radio activity has a duration that is longer than the maximum packet length, the CCA has detected noise and can go back to sleep (if the activity period is not followed by a silence period).
	If the radio activity is followed by a silence period that is longer than the interval between two successive transmissions, the receiver can go back to sleep.
	If the activity period is followed by a silence period of the correct length, followed by activity but no start of packet could be detected, the receiver can go back to sleep.
	
\textbf{Transmission Phase-Lock - }
A sender can learn of a receiver's wake-up phase by making note of the time at which it saw a link layer acknowledgement from the receiver. The sender can assume that the reception of a link layer acknowledgement means that the sender has successfully transmitted a packet within the receiver's wake-up window and thus the sender has found the receiver's wake-up phase. The sender can commence its successive transmissions to this receiver just before the receiver is expected to be awake. The transmission will be significantly shorter than a normal transmission, because it occurs just before the neighbor is expected to be awake. Reducing the length of the transmission thus reduces radio congestion.
	The phase-lock mechanism is implemented as a separate module from ContikiMAC.
	The phase-lock mechanism maintains a list of neighbors and their wake-up phases.
	
Fast sleep and phase-lock optimizations significantly reduce power consumption. This is because of a phase-locked transmission being shorter than non-phased-locked transmissions, leading both to less energy being spent on transmissions and to less radio congestion \cite{contikimac}.

\subsubsection{MiCMAC}
Propose a practical extension of low-power listening, MiCMAC, that performs channel hopping, operates in a distributed way, and is independent of upper layers of the protocol stack. MiCMAC, a channel-hopping variant of ContikiMAC. MiCMAC is based on low-power listening and have nodes wakeup periodically on different channels. MiCMAC is practical and independent from other layers in the protocol stack. MiCMAC employs pseudo-random channel hopping sequences. MiCMAC inherits its basic design from ContikiMAC and extends it for efficient multi-channel support. Inherit its design and integrate channel hopping in it. Each time a node wakes up to listen, it hops (switches) channel according to a pseudo-random sequence. Sender schedules the packet for sending just before Receiver's expected wake-up, switches to Receiver's expected channel, samples it to ensure it is clear, sends the packet and waits for acknowledgement (ACK). If Sender receives the ACK, it knows that communication was successful thus it updates its information of Receiver's wake up time and channel and goes back to sleep. Otherwise, Sender assumes that its information of Receiver's wake-up time and channel is wrong and needs to be updated. Each node switches its channel periodically on every wakeup cycle following a pseudo-random sequence. We generate the pseudo-random channel numbers using a Linear Congruential Generator (LCG). The sequences they generate are uniformly distributed and they are computationally simple.///what is it? reference!///. The generated sequences appear random and contain each possible number in the range exactly once before repeating the whole sequence again. Advantage when we want to find a node's wakeup channel. Do blind channel hopping because of simplicity as local blacklisting would involve some overhead for synchronizing the blacklists among neighbours. "Previous work has shown that even random blind channel hopping improves network connectivity, efficiency and stability when compared to single-channel"///reference??//. To increase optimizations, MiCMAC uses of predefined hopping sequence. Instead of calculating the hopping sequences at runtime, we provide a static table of all sequences used on the network. Each node simply selects its sequence according to its MAC address. MiCMAC extends ContikiMAC's phase-lock with a $channel-lock$ to anticipate the wakeup channel.

When communicating with a neighbour for the first time, the sender picks any channel and transmits strobes repeatedly for a maximum of number of channels wakeup (e.g over four wakeups for four channels). Doing so guarantees that an idle receiver will wake up exactly once on the channel where the strobing occurs. Upon successful unicast reception, the receiver sends an ACK frame that includes the pseudo-random generator parameters so that the sender can compute the next wakeup channels. Next time the same pair of nodes communicates, sender will calculate the next wakeup channel, by generating the receiver's next wakeup channel; taking into account the number of periods elapsed since the last successful unicast. 

MiCMAC supports broadcast by two variants of MiCMAC. i) MiCMAC basic support for broadcast is by strobing only one of the possible channels continuously for N times the wakeup period (sending strobes over one channel for exactly 4 wakeup periods when using 4 channels). Downside is the increased cost in energy and increased channel use. ii) MiCMAC-BC where nodes wake up on a dedicated broadcast channel at every period in addition to their baseline wakeup on the unicast pseudo-random channel. Broadcast transmissions are always done over this channel for a duration of only one wakeup period. Downsides are reduced robustness as all broadcast occur on the same channel and two wakeups are needed instead of one at every period (one wakeup for pseudo-random generated channel, one for broadcast channel).

MiCMAC did not require any change in RPL routing nor other layers. Run RPL with ETX as a metric and the MRHOF objective function. The link ETX between two nodes is updated at every transmission attempt, independent of the channel, resulting in an aggregated estimate over all channels in use.

When using 16 channels, the performance degrades due to using all (including bad) channels and due to increased cost of broadcast and channel-lock operations. MiCMAC sees its performance degrade when using more than 4 channels. The per-channel measurements are not strictly required for MiCMAC to operate but do them for the sake of fair comparison. Channel diversity which increases the number of usable links due to different signal propagation obtained when hopping to a new channel. Channel diversity also leads to a more stable topology, reduced number of parent switches. MiCMAC hides losses from the routing layer, resulting in a more stable topology. \cite{micmac}

\subsubsection{Chrysso}
//inner, outer, scan
Chrysso is a multi-channel protocol extension, that leverages the channel diversity of sensor node radio. Chrysso mitigates the effect of external interference by switching only the affected nodes to a new set of channels effectively evading the interference source on spot. It is specifically tailored to data collection applications ($Collect$ routing protocol), and allocates channels for individual parent-children groups with the parent coordinating a channel switch upon detecting interference. For efficiency nodes normally operate on two channels only, one for incoming and one for outgoing traffic. We also present a novel scanning procedure probing all channels that can be used either at bootstrap or when losing contact with the parent. Chrysso maintains a pre-defined logical list of available channels so that a parent and children are consistent with their view on the next channel. Chrysso implementation uses five 802.15.4 channels: 26, 14, 20, 11 and 22 in the specified order. 

The core of Chrysso is the set of control loops that manages whether a parent-children pair should stay on the same channel or switch to a new channel.

The inner loop is responsible for coordinated channel switching between a parent and its children as soon as external interference is detected. When interference completely block any communication, a coordinated channel switch cannot be performed. For this case, Chrysso uses the outer loop, a watchdog mechanism that initiates an autonomous channel switch.

Inner loop - A child node periodically collects data from the channel quality monitor and piggybacks that onto the data packet. A child node responds to channel switching requests from its parent. Parent uses protocol-stack specific policies to determine whether or not the current measured channel quality indicates external interference. The parent computes an average over the backoff values (congestion backoffs as a measure of interference) and checks whether it exceeds a predetermined threshold. If this is the case, having notified all its children, the parent node switches to the next logical inchannel. 

Outer loop - The outer loop functions as a watchdog for case of severe interference that disrupt the operation of the inner loop. A node (in child and parent role) decides independently to switch channels based on the protocol-specific policies. The decisions involve no explicit coordination between nodes. For detecting severe interference, a child node monitors the number of failed transmissions (messages that were never sent) and switches its outchannel if the failure ratio exceeds a threshold. Autonomous channel switches should only be performed when the inner loop fails to trigger a channel switch for an extended duration. Likewise, the parent switches to the next inchannel when the ratio of received packets drops below a pre-set value.
Child node, if the number of failed transmissions exceeds a certain fraction of the total transmission attempts, then the child node switches its outchannel instantly and autonomously. Likewise, a parent node keeps a record of the number of packet received. If the fraction of received over expected packets falls below a threshold, the parent switches its inchannel instantly and autonomously. 

For a child node, both channel switches and routing switches necessitate a reset of its collected channel quality statistics. The child node also clears its routing entries. The watchdog initiates the scan mode if the node does not find a parent available on the new channel.

Scan mode is invoked at network bootstrap or whenever a sensor node loses connectivity to its parent and has no other entry in its neighbor table (following a channel switch by the outer loop). During scan mode, a sensor node sweeps across the list of channels. The previously used outchannel is blacklisted for that period.

***Fundamental problem of multi-channel protocols: channel deafness (not hearing a packet on a different channel). \cite{chrysso}

Neighbour discovery - Because neighboring nodes operate of different channels, topology information available at a child node is only partial, and also subject to change, as neighbours may switch channel during network operation. Chrysso employs a special neighborhood discovery phase, called $scan mode$ to find a new parent. Scan mode is only triggered on demand as it incurs additional overhead on processing and energy consumption. A node performing neighborhood discovery scans through the list of available channels to search for a new parent. 

\subsection{Comparison and Discussion}
The main features of the presented MAC protocols are summarised in table \ref{table:macProtocol} Existing MAC protocols suffer from several issues:

\begin{enumerate}
\item Synchronous vs asynchronous design \\
Both
\item Sender vs receiver initiated design
\item Channel hopping design
\item Broadcast support
\end{enumerate}

\begin{table}
\centering
\begin{tabular}{|C{2cm}|C{2cm}|C{2.4cm}|C{2cm}|C{2cm}|C{1.8cm}|}
\hline
Protocol & Medium Access & Channel Assignment & Channel Switching & Common Period & Broadcast \\
\hline \hline
MC-LMAC & TDMA & Senders & Once per time slot & CF & Yes \\
\hline
Y-MAC & TDMA + collision window & Dynamic & Once per time slot & CP + CFs & Yes
\\
\hline
TSCH & TDMA + collision window & & & &
\\
\hline
MiCMAC & MiCMAC & Dynamic & One per wake up time & Yes & Yes\\
\hline
Chrysso & Operates over ContikiMAC & Dynamic & Change channel when bad & No & No\\
\hline 
\end{tabular}
\caption{Comparison of studied MAC protocols}
\label{table:macProtocol}
\end{table}

%MC-LMAC
%Medium access TDMA
%Broadcast support Y (COMMON CHANNEL?)
%Common Period YES CF
%Partitions N
%Medium access SCHEDULED
%Channel assignment SENDERS
%Channel switching ONCE PER TIME SLOT
%Joining network ANYTIME

%Y-MAC
%Medium access TDMA + collision window
%Broadcast Y (COMMON CHANNEL)
%Common Period Y CP \& CF
%Partitions N
%Medium access SCHEDULED
%Channel assignment DYNAMIC (SENDERS, RECEIVERS)
%Channel switching ONCE PER TIME SLOT
%Joining network ANYTIME

%TSCH
%Broadcast 

%MiCMAC
%Medium access MICMAC
%Broadcast Y (COMMON CHANNEL)
%Common Period Y (BROADCAST)
%Partitions N
%Medium access MICMAC
%Channel assignment ONCE PER WAKE UP TIME
%Channel switching ONCE PER WAKE UP TIME
%Joining network ANYTIME (COMPATIBLE WITH RPL)

%Chrysso
%Medium access OPERATES OVER MAC
%Broadcast N
%Common Period N
%Partitions N
%Medium access OPERATES OVER MAC
%Channel assignment DYNAMIC (SENDERS? RECEIVERS?)
%Channel switching CHANGE CHANNEL WHEN BAD
%Joining network ANYTIME (COLLECT-TREE)

\section{Routing Protocols (Network Layer Protocols)}
In WSN, the sensor nodes have a limited transmission range.
The network layer is responsible in routing the data across the network from the source to the destination.
Routing protocols for WSNs are responsible for maintaining the routes in the network and ensure reliable multi-hop communication.
Routing protocols in WSNs differs from traditional routing protocols depending on the Operating System.
Contiki provides IP communication in both IPv4 and IPv6. However, as sensors have a small amount of memory, uIP, which is a small RFC-compliant TCP/IP stack that makes it possible to communicate over the Internet \cite{contikiDoc, contikiUIP}. uIP () to reduce the resources it requires.
uIP implementation is designed to have only the absolute minimal set of features needed for a full TCP/IP stack \cite{contikiDoc, contikiUIP}.

\subsection{Introduction}
Flooding and gossiping are two classical mechanism to relay data in sensor networks without the need for any routing algorithms and topology maintenance. In flooding, each sensor receiving a data packet broadcasts it to all of its neighbors and this process continues until the packet arrives at the destination or the maximum number of hops for the packet is reached. Gossiping is a slightly enhanced version of flooding where the receiving node sends the packet to a randomly selected neighbor, which picks another random neighbor to forward the packet to and so on. Easy to implements but have drawbacks include implosion caused by duplicated messages sent to the same node, overlap when two nodes sensing the same region send similar packets to the same neighbor and resource blindness by consuming large amount of energy without consideration for energy constraints. Gossiping cause delays in propagation of data through the nodes. \cite{akkaya2005survey} 

In order to maximize the use of multichannel in improving packet delivery, routing topology plays a big role in providing an optimized routing tree to the network that is scalable and energy efficient. 
Network design objectives - scalability (densely deployed. since the number of sensor nodes are in the order of tens, hundreds or thousands, the network protocols designed should be scalable). Reliability - must provide error control and correction mechanism to ensure reliable data delivery over noisy, error-prone and time-varying wireless channels. Low power consumption - sensor nodes are battery powered, it is crucial to reduce the power consumption of sensor nodes so that the lifetime of the sensor nodes and the network is prolonged). Adaptability - nodes may fail, join or move; network protocols should be adaptive to such density and topology changes. Channel utilization - since sensor nodes have limited bandwidth resources, communication protocols designed for sensor network should efficiently make use of the bandwidth to improve channel utilization (MAC layer??).
Routing protocol approaches can be classified into () types which are flat based and data centric, hierarchical, location based and network flow and quality of service (QoA) aware.

%Nodes closer to the sink need to handle more traffic than nodes in the perimeters.

At the network layer, the main aim is to find ways for energy-efficient route setup and reliable relaying of data from the sensor nodes to the sink so that the lifetime of the network is maximized.

\subsection{Classification of Routing Protocols}
Many routing algorithms (protocols) were developed for WSN. All major routing protocols proposed for WSNs can be divided into ///(). 

Almost all of the routing protocols can be classified as data centric, hierarchical, location based, network flow and quality of service (QoS)-aware based, and hybrid. Data-centric protocols are query-based and depend on the naming of desired data, which helps in eliminating many redundant transmissions. Hierarchical protocols aim at clustering the nodes so that cluster heads can do some aggregation and reduction of data in order to save energy. Location based protocols utilize the position information to relay the data to the desired regions rather than the whole network. Network flow modelling and protocols that strive for meeting some QoS requirements along with the routing function. \cite{akkaya2005survey}
Hybrid approach uses some form of hierarchical technique in combination with other approaches such as network flow to achieve a stable and additional energy saving(???).

The routing protocol is highly influenced by the data delivery model, especially in regard to the minimization of energy consumption and route stability. Similar to MAC protocols(????), the routing protocols can b for continuous, event-driven, query-driven and hybrid. In continuous delivery mode, each sensor sends data periodically. In event-driven and query-driven models, the transmission of data is triggered when an event occurs or a query is generated by the sink. Some networks apply a hybrid model using a combination of continuous, event-driven (sender) and query-driven (receiver) data delivery. \cite{akkaya2005survey}

\subsubsection{Flat based and Data Centric}
In data-centric routing, the sink sends queries to certain regions and waits for data from the sensors located in the selected regions. Since data is being requested through queries, attribute-based naming is necessary to specify the properties of data. 

Data centric - all communication is neighbor-to-neighbor (no need addressing mechanism). 

SPIN \cite{spin} is the first data-centric protocol, which considers data negotiation between nodes in order to eliminate redundant data and save energy.

Later, Directed Diffusion \cite{directeddiffusion} has been developed and has become a breakthrough in data-centric routing. There are many other protocols that have been proposed either based on Directed Diffusion (Rumor Routing \cite{rumorrouting}, GBR \cite{schurgers2001energy}, CADR \cite{cadr})or following a similar concept (TEEN \cite{teen} which is also a hierarchical-based, ACQUIRE \cite{acquire}).

SPIN - the idea behind SPIN is to name the data using high-level descriptors or meta-data. Before transmission, meta-data are exchanged among sensors via a data advertisement mechanism, which is the key feature of SPIN. Each node upon receiving new data advertises it to its neighbors and interested neighbors (sensors advertise the availability of data allowing interested nodes to query that data). 
Difference: In SPIN, sensors advertise the availability of data allowing interested nodes to query that data. (sensor asks others if they want its data)
Advantages: of SPIN is that topological changes are localized since each node needs to know only its single-hop neighbors. 
Disadvantage: SPIN's data advertisement mechanism cannot guarantee the delivery of data. If the nodes that are interested in the data are far away from the source node and the nodes between the source and destination are not interested in that data, such data will not be delivered to the destination at all. 

Directed Diffusion - is an important milestone in the data-centric routing research of sensor networks. The idea aims at diffusing data through sensor nodes by using naming scheme for the data. Direct Diffusion suggests the use of attribute-value pairs for the data and queries the sensors in an on demand basis by using those pairs. The interest is broadcast by a sink through its neighbors. Each node receiving the interest can do caching for later use. The interests in the caches are then used to compare the received data with the values in the interests. A gradient is a reply link to a neighbor from which the interest was received. By utilizing interest and gradients, paths are established between sink and sources. Several paths can be established so that one of them is selected by reinforcement. The sink resends the original interest message through the selected path with a smaller interval. When a path between a source and the sink fails, a new or alternative path should be identified. Directed Diffusion search among other paths which are sending data in lower rates. 
Difference: In Directed Diffusion, the sink queries the sensor nodes if a specific data is available by flooding some tasks. (sink to nodes)
Advantages: Caching is a big advantage in term of energy efficiency and delay. Energy efficient since it is on demand and there is no need for maintaining global network topology.
Disadvantages: Cannot be applied to all sensor network applications since it is based on a query-driven data delivery model.

\subsubsection{Location Based}

\subsubsection{Network Flow and QoS-aware}

\subsubsection{Hierarchical}

\subsubsection{Hybrid Based}
\subsubsection*{CTP}
%2 principles for wireless routing protocols; datapath validation - data traffic quickly discovers and fixes routing inconsistencies; adaptive beaconing - extending the Trickle algorithm to routing control traffic reduces route repair latency and sends fewer beacons. CTP Neo - an implementation of CTP.
%Datapath validation actively uses data packets to validate the routing topology and detect loops. Each data packet contains the link-layer transmitter’s estimate of its distance. A node detects a possible routing loop when it receives a packet to forward from a node with a smaller or equal distance to the destination.
%CTP is a routing protocol that computes anycast routes to a single or a small number of designated sinks in a wireless sensor network. CTP may appear very simple. They provide best-effort, unreliable, anycast packet delivery to one of the data sinks in the network. 
%4 goals; reliability - a protocol should deliver at least 90% of end-to-end packets when a route exists. Robustness - should be able to operate without tuning or configuration in a wide range of network conditions, topologies, workloads and environments. Efficiency - should deliver packets with the minimum amount of transmissions. Hardware independence - without assuming specific radio chip features.
%Rapid topology changes necessitate distance-vector rather than link-state algorithms. Simple distance-vector protocols however suffer from routing loops and other problems that harm reliability and efficiency. Link topology changes may result in transient loops which causes packet drops. A collection protocol builds and maintains minimum cost trees to nodes that advertise themselves as tree roots. Collection is address-free; when there are multiple base stations, it sends to the one with the minimum cost without knowing its address.
%Every node maintains an estimate of the cost of its route to a collection point. ETX as the cost metric (any similar gradient metric can work just well). ETX does not effectively capture throughput. A node’s cost is the cost of its next hop plus the cost of its link to the next hop. The cost of a route is the sum of the costs of its links. Collection points advertise a cost of zero. Each data packet contains the transmitter’s local cost estimates. When a node receives a packet to forward, it compares the transmitter’s cost to its own. Cost must always decrease. 
%When a timer interval expires, Trickle doubles it, up to a maximum value. When Trickle hears a newer version number, it shrinks the timer interval to a small value. Trickle enables quick discovery of new nodes and recovery from failures, while at the same time enabling long beacon intervals when the network is stable \cite{ctp}. 

%CTP provides best effort anycast datagram communication to one of the collection roots in a network. A collection protocol delivers data to one of possibly several data sinks, providing many-to-one network layer. CTP uses routing frames to update and build collection tree in the network. CTP uses data frames to deliver application payload to the sink and to probe topology inconsistencies. 
%	CTP is a tree-based collection protocol. Some nodes advertise as tree roots. Nodes form a set of routing trees to these roots. CTP is address free in that a node does not send a packet to a particular root, instead, it implicitly chooses a root by choosing a next hop. Nodes generate routes to roots using a routing gradient. CTP assumes that it has link quality estimates of some number of nearby neighbors (ETX). These provides an estimate of the number of transmissions it takes for the node to send a unicast packet whose acknowledgement is successfully received. 
%CTP uses expected transmission (ETX) as its routing gradient. A root has an ETX of 0. ETX of a node is the ETX of its parent plus the ETX of its link to its parent. CTP should choose the one with the lowest ETX value. 
%Problem is routing loops; occur when a node choose a new route that has a significantly higher ETX than its old one. CTP tries to resolve the inconsistency by broadcasting a beacon frame. Packet duplication - when a node receives a data frame successfully and transmit an ACK but ACK is not received. Thus CTP keeps a small cache of packet signature for the packets it has seen to detect packet duplicates.CTP data frames has additional time has lived (THL) field which the routing layer increments on each hop. Link-layer retransmission has the same THL.
%If node’s ETX value changes significantly, CTP should transmit a broadcast frame to notify other nodes which might change their routes. A parent can detect when a child’s ETX is significantly below its own. When a parent hears a child advertise an ETX below its own, it must schedule a routing frame for transmission in the near future \cite{ctptep}.

**
Contiki Collect protocol and CTP are state-of-the-art address-free data collection protocols that provide a way for nodes to send data packets towards a data sink. Nodes do not need to know the address of the sink. Use ETX finding paths that minimize the number of packet transmissions to reach the root. Neither CTP nor Contiki Collect are IPv6-based. Contiki Collect uses the Contiki Rime stack \cite{beyondInteroperability}.

The data collection is an address-free protocol that sends messages towards a sink node somewhere in the network. The protocol is address-free in the sense that the originating nodes do not send their messages to a specific addressed node. Instead, the nodes send their messages towards the nearest sink in the network. The protocol does two things. It first builds a tree that originates at the sink nodes. The nodes build the tree by sending periodic announcements containing the number of hops away from the sink. After having built the tree, the nodes start sending messages towards the root of the tree. The protocol sends the messages using hop-by-hop reliable unicast \cite{rime}. 

\subsection*{RPL}
The protocol makes use of IPv6 and supports not only traffic in the upwards direction, but also traffic flowing from a gateway node to all other network participants.
	RPL is a distance vector routing protocol that makes use of IPv6. A Destination Oriented Directed Acyclic Graph (DODAG) which is routed at a single destination is built. 
	The graph is constructed by the use of an Objective Function (OF) which defines how the routing metric is computed. OF specifies how routing constraints and other functions are taken into account during topology construction. The protocol tries to avoid routing loops by computing a node’s position relative to other nodes with respect to the DODAG root, called Rank and increases if nodes move away from the root and decreases when nodes move in the other direction. 
	RPL specification defines 4 types of control messages for topology maintenance and information exchange. DODAG Information Object (DIO) is the main source of routing control information. It may store information like the current Rank of a node, the current RPL Instance, the IPv6 address of the root, etc. Destination Advertisement Object (DAO) enables the support of down traffic and is used to propagate destination information upwards along the DODAG. DODAG Information Solicitation (DIS) makes it possible for a node to require DIO messages from a reachable neighbor. DAO-ACK (optional) is sent by a DAO recipient in response to a DAO message. RPL specification defines all 4 types of control messages as ICMPv6 information messages with a requested type of 155.
	RPL adapts the sending rate of DIO message by extending the Trickle algorithm.
	Upward routing is a standard procedure which enables network devices to send data to a common data sink, also called sometimes a gateway or root node. (BORDER ROUTER??!!)
	The Mode of Operation (MOP) field is set by the DODAG root 
	A DIO message may be extended by the use of options. DODAG Configuration option plays a crucial role for parameter exchange. MaxRankIncrease field defines an upper limit for the Rank. MinHopIncrease field stores the minimum increase of the Rank between a node and any of its parent nodes.
	3 types of nodes in a RPL network. 1. Root nodes which are commonly referred in literature as gateway nodes that provide connectivity to another network. 2. Routers which may advertise topology information to their neighbors. 3. Leafs that do not send any DIO messages and only have the ability to join an existing DODAG. 
	The construction of the topology starts at a root node that begins to send DIO messages. Each node that receives the message run an algorithm to choose an appropriate parent. The choice is based on the used metric and constraints defined by the OF. Afterwards, each of them computes its own Rank and in case a node is a router, it updates the Rank in the DIO message and sends it to all neighboring peers. *In most sensor node deployments several data collection points (root nodes) are needed.
	Whenever the sending timer expired, RPL doubles it up to the maximum value. Whenever RPL detects an event which indicates that the topology needs active maintenance, it resets the timer to minimum value. 
	Router nodes forward DIO control messages for topology maintenance - such messages are sent in a multicast manner to the neighboring nodes. RPL node does not process DIO messages from nodes deeper (higher Rank) than itself. 
	RPL metric - status includes typical resources such as CPU usage, available memory and left energy. Node energy consumption - node should consider the energy level of its neighbors before picking them as possible parents. RPL metric specification defines 3 possible states for the first information field: powered, on batteries and scavenger **** This may be a rough estimation of how much load a node experiences for a given period of time. ETX - is an approximation of the expected number of transmissions until a data packet reaches the gateway node*. A node that is one hop away from the root with perfect signal strength and very little interference may have ETX of 1. ETX is bidirectional single-hop link quality computation between 2 neighbor nodes.* A metric called Packet Reception Rate (PRR) is calculated at the receiver node for each window of received packets.
	Downward routing - by supporting P2MP traffic it is possible for a network administrator to control nodes that are even not in range. RPL specification defines 2 modes of operation for supporting P2MP. 1. Non-storing mode which makes use of source routing. In this mode each node has to propagate its parent list up to the root. After receiving such topology information, the root computes the path to the destinations. Each node has to extend the DAO message. After collecting the needed information, the root pieces the downward route together. If it needs to send a data packet to a given destination the IPv6 Source Routing header is used.  2. Storing mode which is fully stateful. Each non-root and non-leaf network participant has to maintain a routing table for possible destinations. DAO messages are used by RPL nodes to propagate routing information in order to enable P2MP traffic. DAO is no longer propagated to the DODAG root. Instead, it is sent as unicast to all parent nodes which maintain additional downward routing tables \cite{tsvetkov2011rpl}.
	
Routing protocol called RPL. RPL does not define any specific routing metrics, path costs or forwarding policies. RPL leaves this open so that different networks can apply different mechanisms to meet different objectives such as minimizing latency or minimizing energy consumption.
	ContikiRPL implementation of the RPL protocol which allows replaceable routing objective functions. ContikiRPL is the main IPv6 routing protocol in Contiki. RPL is a distance-vector protocol for IPv6 networks comprising low-power devices connected by lossy links. The protocol maintains Directed Acyclic Graph (DAG) topologies toward root nodes. The topologies are built proactively according to an objective function. It is flexible regarding the rules to form topologies and to select next-hops for individual packets. Routing decisions are taken by the objective function, which essentially specifies the constraints and metrics used in a network. 
	One objective function uses a simple hop count and one uses expected transmissions (ETX) to do the forwarding decision. The simple hop-count objective function results in a shorter path length at the expense of higher power consumption \cite{tsiftes_framework_2010}.
	
DIS - may be used to solicit a DIO from a RPL node. A node may use DIS to probe its neighborhood for nearby DODAGs.
DIO - carries information that allows a node to discover a RPL Instance, learn its configuration parameters, select a DODAG parent set and maintain the DODAG.
DAO - used to propagate destination information Upward along the DODAG. In Storing mode, the DAO message is unicast by the child to the selected parent(s). In Non-Storing mode, the DAO message is unicast to the DODAG root. The DAO message may optionally be acknowledged by its destination with a Destination Advertisement Acknowledgement (DAO-ACK) message back to the sender of the DAO. DAO-ACK message is sent as a unicast message packet by a DAO recipient (a parent or DODAG root) in response to a unicast DAO message \cite{winter2012rpl}.

RPL is a routing protocol that provides any-to-any routing in low-power Ipv6 networks, standardized by the IETF in March 2012. Its design is largely based on CTP, the reference data collection protocol for sensor networks. The RPL topology is a DODAG (Destination Oriented Directed Acyclic Graph) built in direction of the root, typically an access point to the Internet. Any-to-any traffic is routed first upwards, i.e. towards the root until a common ancestor of destination and source is found, and then downwards, following the nodes routing table. RPL uses a simple rooted topology instead of a full mesh; it is devoted to the maintenance of reliable paths to a single destination. The purpose of this strategy is to scale to large networks while containing the routing overhead, at the price of increased hop count (routing via a common ancestor). RPL terminology, the distance from a node to the root according to the routing metric is called rank. RPL requires sharing routing tables among siblings. In RPL, nodes propagate their routing entries through unicast (so-called DAO messages) to their parents. RPL’s rank hysteresis mechanism prevents nodes from switching parent for too little rank improvements. ContikiMAC – has wakeup consists of two clear channel assessments and has a phase-lock mechanism where senders record their neighbor’s wake-up phase and use it to make the next transmissions cheaper. *Experience an outage during which they cannot receive or send any data. This reflects for example scenarios where battery maintenance requires to disconnect a part of the network, or where external interference (e.g. WiFi or Bluetooth) affects communication. RPL experiences a sharp drop in the reliability during the first outage, consequence of failed MAC transmissions. Nodes react by switching parent, which heals the topology and slowly improves reliability. The next outages result in less churn (less agitate) \cite{orpl}.

////OBJECTIVE FUNCTION

////TRICKLE TIMER
A protocol uses Trickle to periodically advertise the most recent data it has received, typically through a version number. Routing control traffic - a protocol uses Trickle to control when it sends beacons that contain routing state.
Once the RPL network is established, it reduces the rate of control messages, exponential increase. To avoid control message explosion, nodes suppress transmissions if it hears too many messages from other - called the Trickle algorithm. 

Dynamically adjusting transmission windows allows Trickle to spread new information on the scale of link-layer transmission times while sending only a few messages per hour when information does not change.

To save energy the DIOs are sent periodically controlled by the trickle timer whose duration is doubled each time it is fired. The value of trickle timer starts from the lowest possible value lmin and is doubled each time it is transmitted until it reaches its maximum possible value of lmax \cite{trickle}.

\subsubsection{Comparison and Discussion}